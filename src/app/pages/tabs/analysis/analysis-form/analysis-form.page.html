<app-header backButton="/tabs/analysis" title="Nuevo análisis"></app-header>
<ion-content>
  <div class="wrapper">
    <div class="form">
      <!-- Departamento  -->

      <app-input-costum
        [selectOptions]="this.departamentos"
        [viewField]="'nombre'"
        [valueField]="'nombre'"
        label="Departamento"
        type="select"
        [formControlValue]="departamento"
      ></app-input-costum>
      <div
        class="validators"
        *ngIf="departamento.touched && departamento.errors"
      >
        <span *ngIf="departamento.errors?.['required']"
          >Selecciona el departamento donde está ubicada la empresa</span
        >
      </div>

      <!-- Municipio  -->
      <app-input-costum
        [selectOptions]="this.municipios"
        [viewField]="'nombre'"
        [valueField]="'nombre'"
        label="Municipio"
        type="select"
        [formControlValue]="municipio"
        (disabled)="!departamento.value"
      ></app-input-costum>
      <div class="validators" *ngIf="municipio.touched && municipio.errors">
        <span *ngIf="municipio.errors?.['required']"
          >Selecciona el municipio donde está ubicada la empresa</span
        >
      </div>

      <app-input-gradient
        label="Número de guía"
        type="string"
        [formControlValue]="guia"
      >
      </app-input-gradient>
      <div class="validators" *ngIf="guia.dirty && guia.errors">
        <span *ngIf="guia.errors?.['required']">Ingresa el No. de guía.</span>
      </div>

      <app-input-gradient
        label="Placa"
        type="string"
        [formControlValue]="placa"
      >
      </app-input-gradient>
      <div class="validators" *ngIf="placa.dirty && placa.errors">
        <span *ngIf="placa.errors?.['required']"
          >Ingresa la placa del vehiculo.</span
        >
      </div>

      <!-- Añadir Ubicación -->
      <div
        *ngIf="longitude && latitude"
        class="animate__animated animate__fadeIn label"
      >
        Ubicación
      </div>
      <app-input-gradient
        class=".label-left"
        icon="location-outline"
        label="{{longitude && latitude ? latitude+', '+longitude : 'Añadir Ubicación'}}"
        type="button"
        (click)="getCurrentPosition()"
      >
      </app-input-gradient>

      <!-- Button -->
      <div *ngIf="!loading" class="btn-gradient">
        <ion-button
          (click)="updateReport()"
          [disabled]="!validator()"
          mode="ios"
        >
          <span>Comenzar</span>
        </ion-button>
      </div>

      <!-- Button Loading-->
      <div *ngIf="loading" class="btn-gradient">
        <ion-button class="btn-loading" disabled mode="ios">
          <span>
            <ion-spinner slot="end" color="dark"></ion-spinner>
          </span>
        </ion-button>
      </div>
    </div>
  </div>
</ion-content>
